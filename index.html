<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerenciador de VÃ´lei</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>

    <div class="app-container">
        <nav class="tabs">
            <button class="tab-link active" data-tab="config">âš™ï¸ InÃ­cio</button>
            <button class="tab-link" data-tab="cadastro">ğŸ“ Cadastro</button>
            <button class="tab-link" data-tab="jogadores">ğŸ“š Jogadores</button>
            <button class="tab-link" data-tab="times">ğŸ‘¥ Times</button>
            <button class="tab-link" data-tab="partidas">âš”ï¸ Jogos</button>
            <button class="tab-link" data-tab="placar">ğŸ”¢ Placar</button>
            <button class="tab-link" data-tab="resultados">ğŸ“Š Resultados</button>
            <button class="tab-link" data-tab="historico" id="btn-open-history">ğŸ•˜ HistÃ³rico</button>
        </nav>

        <main class="tab-content-container glass">

            <section id="cadastro" class="tab-content">
                <h2>ğŸ“ Cadastro de Jogadores</h2>
                <p>Informe os dados do jogador. Habilidade vai de 1 (iniciante) a 5 (avanÃ§ado).</p>
                <div class="form-grid">
                    <label>
                        Nome
                        <input type="text" id="player-name" placeholder="Ex.: Maria Silva" />
                    </label>
                    <label>
                        Sexo
                        <div class="radio-group">
                            <label><input type="radio" name="player-gender" value="M" /> Masculino</label>
                            <label><input type="radio" name="player-gender" value="F" /> Feminino</label>
                        </div>
                    </label>
                    <label>
                        Habilidade (1-5)
                        <select id="player-skill">
                            <option value="1">1 - Iniciante (aprendendo regras bÃ¡sicas)</option>
                            <option value="2">2 - BÃ¡sico (recebe/levanta com constÃ¢ncia)</option>
                            <option value="3">3 - IntermediÃ¡rio (bom posicionamento e passes)</option>
                            <option value="4">4 - AvanÃ§ado (ataque/bloqueio eficientes)</option>
                            <option value="5">5 - Competitivo (alto desempenho constante)</option>
                        </select>
                    </label>
                    <label>
                        Status
                        <div class="radio-group">
                            <label><input type="checkbox" id="player-active" checked /> Ativo</label>
                        </div>
                    </label>
                </div>
                <div style="display:flex; gap:10px; flex-wrap: wrap; margin-top: 10px;">
                    <button id="btn-add-player" class="btn-green">â• Adicionar</button>
                </div>
                <small style="display:block; margin-top:8px; opacity:.8">Dica: os jogadores sÃ£o salvos automaticamente no banco local do navegador e podem sincronizar com o Supabase quando conectado.</small>
            </section>


            <section id="config" class="tab-content active">
                <h2>âš™ï¸ InÃ­cio</h2>
                <p style="opacity:.8;">Escolha uma opÃ§Ã£o para acessar rapidamente outras telas do sistema.</p>
                <div class="glass" style="padding:10px 12px; margin:10px 0; display:flex; align-items:center; gap:10px;">
                    <span style="opacity:.9;">ğŸ“Š ReferÃªncia rÃ¡pida: HistÃ³rico de Jogos do Dia</span>
                    <button class="icon-btn" data-tab-target="historico" style="margin:0;">Ver HistÃ³rico</button>
                </div>
                <div class="home-grid" style="margin-top: 10px;">
                    <button class="home-card" data-tab-target="cadastro">ğŸ“ Cadastro</button>
                    <button class="home-card" data-tab-target="jogadores">ğŸ“š Jogadores</button>
                    <button class="home-card" data-tab-target="times">ğŸ‘¥ Times</button>
                    <button class="home-card" data-tab-target="partidas">âš”ï¸ Jogos</button>
                    <button class="home-card" data-tab-target="placar">ğŸ”¢ Placar</button>
                    <button class="home-card" data-tab-target="resultados">ğŸ“Š Resultados</button>
                </div>
                <!-- ConexÃ£o com base de dados removida do formulÃ¡rio. Status abaixo no rodapÃ©. -->
            </section>

            <section id="jogadores" class="tab-content">
                <h2>ğŸ“š Lista de Jogadores</h2>
                <div style="display:flex; gap:10px; flex-wrap: wrap; margin-bottom: 12px; align-items:center;">
                    <input id="player-search" type="text" placeholder="Buscar por nome..." style="flex:1; min-width:200px;">
                    <label style="display:flex; align-items:center; gap:6px; white-space:nowrap;">
                        <input type="checkbox" id="toggle-ativos" /> Mostrar apenas ativos
                    </label>
                    <button id="btn-sortear" class="btn-green" style="font-size: 1.0em;">ğŸ² Sortear Times Balanceados</button>
                    <button id="btn-clear-presentes" class="btn-red">ğŸ—‘ï¸ Limpar SeleÃ§Ã£o</button>
                </div>
                <div id="players-list" class="players-list"></div>
            </section>

            <section id="times" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2 style="margin:0; border:none;">ğŸ‘¥ Times Definidos</h2>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <button id="btn-copy-teams" class="btn-green" style="width: auto; margin: 0; padding: 8px 20px;">Copiar Lista</button>
                        <button class="icon-btn" data-tab-target="partidas" style="margin:0;">â¡ï¸ Ir para Ordem de Jogos</button>
                    </div>
                </div>
                <div id="teams-output"></div>
            </section>

            <section id="partidas" class="tab-content">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                    <h2 style="margin:0; border:none;">âš”ï¸ Ordem dos Jogos</h2>
                    <div style="display:flex; gap:8px; align-items:center;">
                        <button id="btn-copy-matches" class="btn-green" style="width: auto; margin: 0; padding: 8px 20px;">Copiar Jogos</button>
                        <button class="icon-btn" data-tab-target="placar" style="margin:0;">â¡ï¸ Ir para Placar</button>
                    </div>
                </div>
                <div style="background: rgba(33, 150, 243, 0.15); padding: 15px; border-radius: 10px; margin-bottom: 20px; border: 1px solid rgba(33, 150, 243, 0.3);">
                    â„¹ï¸ <strong>Regra de Pausa:</strong> Times nÃ£o devem jogar mais de 2 partidas seguidas sem descanso.
                </div>
                <ul id="match-list"></ul>
            </section>

            <section id="placar" class="tab-content">
                <h2>ğŸ”¢ Placar ao Vivo</h2>
                <div style="background: rgba(0,0,0,0.3); padding: 20px; border-radius: 14px; margin-bottom: 30px;">
                    <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                        <select id="match-selector" style="margin-top: 0; flex: 3; min-width: 200px;">
                            <option value="">-- Selecione o prÃ³ximo jogo --</option>
                        </select>
                        <button id="btn-start-match" style="margin-top: 0; flex: 1; min-width: 120px;">â–¶ï¸ INICIAR</button>
                    </div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-top: 12px;">
                        <select id="manual-team-a" style="margin-top: 0; flex: 1; min-width: 150px;">
                            <option value="">Time A (extra)</option>
                        </select>
                        <select id="manual-team-b" style="margin-top: 0; flex: 1; min-width: 150px;">
                            <option value="">Time B (extra)</option>
                        </select>
                        <button id="btn-start-extra" class="btn-green" style="margin-top: 0; flex: 1; min-width: 120px;">ğŸ² Jogo Extra</button>
                    </div>
                </div>

                <div class="scoreboard">
                    <div class="score-team">
                        <h3 id="team-a-name" style="min-height: 2.4em; display: flex; align-items: center; justify-content: center;">Time A</h3>
                        <div class="score-val" id="score-a">0</div>
                        <div class="score-controls">
                            <button class="btn-score-minus" data-team="a" disabled>-</button>
                            <button class="btn-score" data-team="a" disabled>+</button>
                        </div>
                    </div>
                    <div style="font-size: 2em; opacity: 0.5;">X</div>
                    <div class="score-team">
                        <h3 id="team-b-name" style="min-height: 2.4em; display: flex; align-items: center; justify-content: center;">Time B</h3>
                        <div class="score-val" id="score-b">0</div>
                        <div class="score-controls">
                            <button class="btn-score-minus" data-team="b" disabled>-</button>
                            <button class="btn-score" data-team="b" disabled>+</button>
                        </div>
                    </div>
                </div>

                <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                    <button id="btn-reset-score" style="background: #555; flex: 1;">ğŸ”„ Reiniciar</button>
                    <button id="btn-finish-match" class="btn-green" style="flex: 2;" disabled>âœ… Finalizar Partida</button>
                </div>
            </section>

            <section id="resultados" class="tab-content">
                <h2>ğŸ“Š HistÃ³rico do Dia</h2>
                <div class="results-controls" style="display:flex; gap:8px; flex-wrap:nowrap; align-items:center; margin-bottom:10px;">
                    <input type="date" id="filter-date" style="margin-top:0; min-width:120px; width:120px;">
                    <select id="filter-page-size" style="margin-top:0; min-width:120px; width:140px;">
                        <option value="10">10 por pÃ¡gina</option>
                        <option value="20">20 por pÃ¡gina</option>
                        <option value="50">50 por pÃ¡gina</option>
                    </select>
                    <button id="btn-apply-filters" class="btn-green" style="margin-top:0;">ğŸ” Pesquisar</button>
                    <button id="btn-sync-db" class="btn-green" style="margin-top:0;">ğŸ”„ Sincronizar</button>
                </div>
                <table id="results-table" class="results-table">
                    <thead>
                        <tr>
                            <th>Hora</th>
                            <th>Time A</th>
                            <th>Placar</th>
                            <th>Time B</th>
                            <th>Vencedor</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div id="results-pagination" class="results-pagination" style="display:flex; gap:8px; align-items:center; justify-content:flex-end; margin-top:10px;">
                    <button id="page-prev" style="margin:0;">â—€ï¸ Anterior</button>
                    <span id="page-info" style="opacity:.8;">PÃ¡gina 1</span>
                    <button id="page-next" style="margin:0;">PrÃ³xima â–¶ï¸</button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin-top: 20px;">
                    <button id="btn-copy-results" class="btn-green" style="margin:0">ğŸ“‹ Copiar</button>
                    <button id="btn-download-pdf" style="margin:0; background: #ff9800; color: #12121e;">ğŸ’¾ PDF</button>
                    <button id="btn-clear-results" class="btn-red" style="margin:0">ğŸ—‘ï¸ Limpar</button>
                </div>
            </section>

            <section id="historico" class="tab-content">
                <h2>ğŸ•˜ HistÃ³rico Geral</h2>
                <p style="opacity:.8;">Exibe apenas partidas de dias anteriores.</p>
                <div class="results-controls" style="display:flex; gap:8px; flex-wrap:nowrap; align-items:center; margin-bottom:10px;">
                    <select id="history-page-size" style="margin-top:0; min-width:120px; width:140px;">
                        <option value="10">10 por pÃ¡gina</option>
                        <option value="20">20 por pÃ¡gina</option>
                        <option value="50">50 por pÃ¡gina</option>
                    </select>
                </div>
                <table id="history-table" class="results-table">
                    <thead>
                        <tr>
                            <th>Data</th>
                            <th>Hora</th>
                            <th>Time A</th>
                            <th>Placar</th>
                            <th>Time B</th>
                            <th>Vencedor</th>
                        </tr>
                    </thead>
                    <tbody></tbody>
                </table>
                <div id="history-pagination" class="results-pagination" style="display:flex; gap:8px; align-items:center; justify-content:flex-end; margin-top:10px;">
                    <button id="history-page-prev" style="margin:0;">â—€ï¸ Anterior</button>
                    <span id="history-page-info" style="opacity:.8;">PÃ¡gina 1</span>
                    <button id="history-page-next" style="margin:0;">PrÃ³xima â–¶ï¸</button>
                </div>
            </section>

        </main>
    </div>

    <textarea id="clipboard-helper" class="copy-area"></textarea>
    <div id="toast-container" class="toast-container"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <!-- ConfiguraÃ§Ã£o Supabase em arquivo separado (preencha supabase.config.js) -->
    <script src="supabase.config.js"></script>
    <script src="script.js"></script>
    <footer class="app-footer" style="margin-top:20px; text-align:center; opacity:.8;">
        <span id="db-status-footer">BD: offline</span>
    </footer>
</body>
</html>
